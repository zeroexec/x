<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Core System</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { 
            --accent: #00e5ff; 
            --accent-rgb: 0, 229, 255; 
            --bg: #000; 
        }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: var(--bg); overflow: hidden; 
            font-family: 'Courier New', monospace;
            cursor: none;
        }
        canvas { 
            position: fixed; 
            inset: 0; 
            pointer-events: none;
            will-change: transform;
        }
        #particle-canvas { z-index: 1; }
        #cursor-canvas { z-index: 9999; }
        .system-root {
            position: relative; z-index: 10; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: radial-gradient(circle at center, rgba(var(--accent-rgb), 0.05) 0%, transparent 70%);
        }
        .entity-container {
            position: relative; padding: 100px;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; transform: scale(0.9);
            transition: all 1.5s cubic-bezier(0.16, 1, 0.3, 1);
            will-change: transform, opacity;
        }
        .entity-container.active { opacity: 1; transform: scale(1); }
        #displayLogo {
            max-width: 280px; max-height: 280px;
            position: relative; z-index: 5;
            animation: breath 5s ease-in-out infinite;
            will-change: transform, filter;
        }
        .hologram-ring {
            position: absolute; border: 1px solid var(--accent);
            border-radius: 50%; opacity: 0.3;
            animation: pulse-ring 4s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
            pointer-events: none;
        }
        .ring-inner { width: 320px; height: 320px; border-width: 2px; }
        .ring-outer { width: 450px; height: 450px; border-style: double; animation-delay: -1s; }
        .terminal-box {
            position: absolute; bottom: 30px; left: 30px;
            color: var(--accent); font-size: 11px; text-transform: uppercase;
            letter-spacing: 2px; opacity: 0.7;
            pointer-events: none;
        }
        @keyframes breath {
            0%, 100% { transform: scale(1); filter: brightness(1) drop-shadow(0 0 15px var(--accent)); }
            50% { transform: scale(1.03); filter: brightness(1.2) drop-shadow(0 0 30px var(--accent)); }
        }
        @keyframes pulse-ring {
            0% { transform: scale(0.85); opacity: 0.4; }
            100% { transform: scale(1.25); opacity: 0; }
        }
    </style>
</head>
<body>

    <canvas id="particle-canvas"></canvas>
    <canvas id="cursor-canvas"></canvas>

    <div class="system-root">
        <div class="entity-container" id="mainCore">
            <div class="hologram-ring ring-inner"></div>
            <div class="hologram-ring ring-outer"></div>
            <img id="displayLogo" src="" alt="System Entity">
        </div>
        <div class="terminal-box">
            <div>> CONNECTION_STATE: ENCRYPTED</div>
            <div>> MOUSE_STREAM: CAPTURING_CORE</div>
            <div style="color: #fff">> STATUS: STANDBY_MODE</div>
        </div>
    </div>

    <script>
        const client = supabase.createClient('https://nynowiamkpddohtaoqvt.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im55bm93aWFta3BkZG9odGFvcXZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2MzQyODEsImV4cCI6MjA4MjIxMDI4MX0.vN7m2SUztxtHUROEMOqtbqMGRPehM9UJZP_VSsVMRtw');
        
        const pCanvas = document.getElementById('particle-canvas');
        const pCtx = pCanvas.getContext('2d', { alpha: false }); 
        const cCanvas = document.getElementById('cursor-canvas');
        const cCtx = cCanvas.getContext('2d', { alpha: true });
        
        let particles = [];
        let mouseParticles = [];
        let mx = window.innerWidth / 2, my = window.innerHeight / 2;
        let width, height;

        function resize() {
            width = pCanvas.width = cCanvas.width = window.innerWidth;
            height = pCanvas.height = cCanvas.height = window.innerHeight;
        }

        class FireParticle {
            constructor(x, y) {
                this.reset(x, y);
            }
            reset(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 8 + 3;
                this.speedY = Math.random() * -1.5 - 0.5;
                this.speedX = (Math.random() - 0.5) * 1.2;
                this.life = 1;
                this.decay = Math.random() * 0.02 + 0.015;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.size *= 0.97;
                this.life -= this.decay;
            }
            draw() {
                cCtx.fillStyle = `hsla(185, 100%, 50%, ${this.life})`;
                cCtx.beginPath();
                cCtx.arc(this.x, this.y, this.size, 0, 6.28);
                cCtx.fill();
            }
        }

        window.addEventListener('mousemove', (e) => {
            mx = e.clientX;
            my = e.clientY;
            if (mouseParticles.length < 50) {
                mouseParticles.push(new FireParticle(mx, my));
            }
        }, { passive: true });

        function animate() {
            pCtx.fillStyle = '#000';
            pCtx.fillRect(0, 0, width, height);
            
            pCtx.fillStyle = 'rgba(0, 229, 255, 0.3)';
            for (let i = 0; i < particles.length; i++) {
                let p = particles[i];
                p.x += p.vx; 
                p.y += p.vy;
                if(p.x < 0) p.x = width;
                else if(p.x > width) p.x = 0;
                if(p.y < 0) p.y = height;
                else if(p.y > height) p.y = 0;
                pCtx.fillRect(p.x, p.y, 1.2, 1.2);
            }

            cCtx.clearRect(0, 0, width, height);
            
            cCtx.strokeStyle = 'rgba(255, 255, 255, 0.6)';
            cCtx.lineWidth = 1.5;
            cCtx.beginPath();
            cCtx.arc(mx, my, 8, 0, 6.28);
            cCtx.stroke();

            for(let i = mouseParticles.length - 1; i >= 0; i--){
                const p = mouseParticles[i];
                p.update();
                p.draw();
                if(p.life <= 0) {
                    mouseParticles.splice(i, 1);
                }
            }
            requestAnimationFrame(animate);
        }

        async function init() {
            resize();
            particles = [];
            for(let i=0; i<70; i++) {
                particles.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    vx: (Math.random() - 0.5) * 0.3,
                    vy: (Math.random() - 0.5) * 0.3
                });
            }
            animate();
            
            try {
                const { data } = await client.from('settings').select('site_favicon').eq('id', 1).maybeSingle();
                if (data?.site_favicon) {
                    const img = document.getElementById('displayLogo');
                    img.src = data.site_favicon;
                    img.onload = () => document.getElementById('mainCore').classList.add('active');
                }
            } catch (e) {
                console.error("Supabase Error:", e);
            }
        }

        window.addEventListener('resize', resize, { passive: true });
        init();
    </script>
</body>
</html>
